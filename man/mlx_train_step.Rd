% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/optim.R
\name{mlx_train_step}
\alias{mlx_train_step}
\title{Single training step helper}
\usage{
mlx_train_step(module, loss_fn, optimizer, ...)
}
\arguments{
\item{module}{An \code{mlx_module}.}

\item{loss_fn}{Function of \code{module} and data returning an \code{mlx} scalar.}

\item{optimizer}{Optimizer object from \code{mlx_optimizer_sgd()}.}

\item{...}{Additional data passed to \code{loss_fn}.}
}
\value{
A list with the current loss.
}
\description{
Single training step helper
}
\examples{
set.seed(1)
model <- mlx_linear(2, 1, bias = FALSE)
opt <- mlx_optimizer_sgd(mlx_parameters(model), lr = 0.1)
data_x <- as_mlx(matrix(c(1, 2, 3, 4), 2, 2))
data_y <- as_mlx(matrix(c(1, 2), 2, 1))
loss_fn <- function(mod, x, y) {
  preds <- mlx_forward(mod, x)
  diff <- preds - y
  sum(diff * diff)
}
mlx_train_step(model, loss_fn, opt, data_x, data_y)
}
\seealso{
\url{https://ml-explore.github.io/mlx/build/html/python/nn.html#mlx.optimizers.Optimizer}
}
