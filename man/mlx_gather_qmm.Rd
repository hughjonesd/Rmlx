% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/nn.R
\name{mlx_gather_qmm}
\alias{mlx_gather_qmm}
\title{Gather-based Quantized Matrix Multiplication}
\usage{
mlx_gather_qmm(
  x,
  w,
  scales,
  biases = NULL,
  lhs_indices = NULL,
  rhs_indices = NULL,
  transpose = TRUE,
  group_size = 64L,
  bits = 4L,
  mode = "affine",
  sorted_indices = FALSE,
  device = mlx_default_device()
)
}
\arguments{
\item{x}{An mlx array.}

\item{w}{An mlx array (the quantized weight matrix)}

\item{scales}{An mlx array (the quantization scales)}

\item{biases}{An optional mlx array (biases to add). Default: NULL}

\item{lhs_indices}{An optional mlx array (indices for gathering from x). Default: NULL}

\item{rhs_indices}{An optional mlx array (indices for gathering from w). Default: NULL}

\item{transpose}{Whether to transpose the weight matrix. Default: TRUE}

\item{group_size}{The group size for quantization. Default: 64}

\item{bits}{The number of bits for quantization (typically 4 or 8). Default: 4}

\item{mode}{The quantization mode, either "affine" or "mxfp4". Default: "affine"}

\item{sorted_indices}{Whether the indices are sorted (enables optimizations). Default: FALSE}

\item{device}{Device for computation: \code{"gpu"} or \code{"cpu"}. Default: \code{mlx_default_device()}.}
}
\value{
An mlx array with the result of the gather-based quantized matrix multiplication
}
\description{
Performs quantized matrix multiplication with optional gather operations on inputs.
This is useful for combining embedding lookups with quantized linear transformations,
a common pattern in transformer models.
}
\details{
This function combines gather operations (indexed lookups) with quantized matrix
multiplication. When lhs_indices is provided, it performs \code{x[lhs_indices]} before
the multiplication. Similarly, rhs_indices gathers from the weight matrix.

This is particularly efficient for transformer models where you need to look up
token embeddings and then apply a quantized linear transformation in one fused
operation.
}
\seealso{
\code{\link[=mlx_quantized_matmul]{mlx_quantized_matmul()}}

\url{https://ml-explore.github.io/mlx/build/html/python/nn.html}
}
