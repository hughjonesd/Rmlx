% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/device.R
\name{with_default_device}
\alias{with_default_device}
\title{Temporarily set the default MLX device}
\usage{
with_default_device(device, code)
}
\arguments{
\item{device}{Execution target: supply \code{"gpu"}, \code{"cpu"}, or an
\code{mlx_stream} created via \code{\link[=mlx_new_stream]{mlx_new_stream()}}. Defaults to the current
\code{\link[=mlx_default_device]{mlx_default_device()}} unless noted otherwise (helpers that act on an existing
array typically reuse that array's device or stream).}

\item{code}{Expression to evaluate while \code{device} is active.}
}
\value{
The result of evaluating \code{code}.
}
\description{
Temporarily set the default MLX device
}
\examples{
old <- mlx_default_device()
with_default_device("cpu", mlx_default_device())
mlx_default_device(old)
}
\seealso{
\href{https://ml-explore.github.io/mlx/build/html/python/metal.html}{mlx.core.default_device}
}
