% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/stats.R
\name{mlx_quantile}
\alias{mlx_quantile}
\alias{quantile.mlx}
\title{Compute quantiles of MLX arrays}
\usage{
mlx_quantile(
  x,
  probs,
  axis = NULL,
  drop = FALSE,
  device = mlx_default_device()
)

\method{quantile}{mlx}(x, probs, ...)
}
\arguments{
\item{x}{An mlx array, or an R array/matrix/vector that will be converted via \code{\link[=as_mlx]{as_mlx()}}.}

\item{probs}{Numeric vector of probabilities in [0, 1].}

\item{axis}{Optional integer axis (or vector of axes) along which to compute
quantiles. When \code{NULL} (default), quantiles are computed over the entire
flattened array.}

\item{drop}{Logical; when \code{TRUE} and computing quantiles along an axis with a
single probability, removes the quantile dimension of length 1. Defaults to
\code{FALSE} to match the behavior of other reduction functions.}

\item{device}{Execution target: supply \code{"gpu"}, \code{"cpu"}, or an
\code{mlx_stream} created via \code{\link[=mlx_new_stream]{mlx_new_stream()}}. Default: \code{mlx_default_device()}.}

\item{...}{Additional arguments (currently ignored by \code{quantile.mlx()}).}
}
\value{
An mlx array containing the requested quantiles. The shape depends on
\code{probs}, \code{axis}, and \code{drop}: when \code{axis = NULL}, returns a scalar for a
single probability or a vector for multiple probabilities. When \code{axis} is
specified, the quantile dimension replaces the reduced axis (e.g., a \verb{(3, 4)}
matrix with \code{axis = 1} and 2 quantiles gives \verb{(2, 4)}), unless \code{drop = TRUE}
with a single probability removes that dimension.
}
\description{
Calculates sample quantiles corresponding to given probabilities using linear
interpolation (R's type 7 quantiles, the default in \code{\link[stats:quantile]{stats::quantile()}}).
The S3 method \code{quantile.mlx()} provides an interface compatible with the
generic \code{\link[stats:quantile]{stats::quantile()}}.
}
\details{
Uses type 7 quantiles (linear interpolation): for probability p and n
observations, the quantile is computed as:
\itemize{
\item h = (n-1) * p
\item Interpolate between floor(h) and ceiling(h)
}

This matches the default behavior of \code{\link[stats:quantile]{stats::quantile()}}.
}
\examples{
x <- as_mlx(1:10)
as.numeric(mlx_quantile(x, 0.5))  # median
as.numeric(mlx_quantile(x, c(0.25, 0.5, 0.75)))  # quartiles

# S3 method:
quantile(x, probs = c(0, 0.25, 0.5, 0.75, 1))

# With axis parameter, quantile dimension replaces the reduced axis:
mat <- as_mlx(matrix(1:12, 3, 4))  # shape (3, 4)
result <- mlx_quantile(mat, c(0.25, 0.75), axis = 1)  # shape (2, 4)
result <- mlx_quantile(mat, 0.5, axis = 1)  # shape (1, 4)
result <- mlx_quantile(mat, 0.5, axis = 1, drop = TRUE)  # shape (4,)
}
\seealso{
\code{\link[stats:quantile]{stats::quantile()}},
\href{https://ml-explore.github.io/mlx/build/html/python/array.html#mlx.core.sort}{mlx.core.sort}
}
