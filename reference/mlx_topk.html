<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Top-k selection and partitioning on mlx arrays — mlx_topk • Rmlx</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Top-k selection and partitioning on mlx arrays — mlx_topk"><meta name="description" content="mlx_topk() returns the largest k values. mlx_partition() and
mlx_argpartition() perform partial sorting, rearranging elements so that
the element at position kth is in its correctly sorted position, with all
smaller elements before it and all larger elements after it. This is more
efficient than full sorting when you only need elements up to a certain rank."><meta property="og:description" content="mlx_topk() returns the largest k values. mlx_partition() and
mlx_argpartition() perform partial sorting, rearranging elements so that
the element at position kth is in its correctly sorted position, with all
smaller elements before it and all larger elements after it. This is more
efficient than full sorting when you only need elements up to a certain rank."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">Rmlx</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/benchmarks.html">MLX Benchmarks</a></li>
    <li><a class="dropdown-item" href="../articles/getting-started.html">Getting Started with Rmlx</a></li>
    <li><a class="dropdown-item" href="../articles/linear-regression.html">Linear Regression with MLX</a></li>
    <li><a class="dropdown-item" href="../articles/neural-networks.html">Neural Networks with Rmlx</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/hughjonesd/Rmlx/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Top-k selection and partitioning on mlx arrays</h1>
      <small class="dont-index">Source: <a href="https://github.com/hughjonesd/Rmlx/blob/master/R/transform.R" class="external-link"><code>R/transform.R</code></a></small>
      <div class="d-none name"><code>mlx_topk.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>mlx_topk()</code> returns the largest <code>k</code> values. <code>mlx_partition()</code> and
<code>mlx_argpartition()</code> perform partial sorting, rearranging elements so that
the element at position <code>kth</code> is in its correctly sorted position, with all
smaller elements before it and all larger elements after it. This is more
efficient than full sorting when you only need elements up to a certain rank.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">mlx_topk</span><span class="op">(</span><span class="va">x</span>, <span class="va">k</span>, axis <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">mlx_partition</span><span class="op">(</span><span class="va">x</span>, <span class="va">kth</span>, axis <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">mlx_argpartition</span><span class="op">(</span><span class="va">x</span>, <span class="va">kth</span>, axis <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>An mlx array, or an R array/matrix/vector that will be converted via <code><a href="as_mlx.html">as_mlx()</a></code>.</p></dd>


<dt id="arg-k">k<a class="anchor" aria-label="anchor" href="#arg-k"></a></dt>
<dd><p>Positive integer specifying the number of elements to select.</p></dd>


<dt id="arg-axis">axis<a class="anchor" aria-label="anchor" href="#arg-axis"></a></dt>
<dd><p>Optional axis to operate over (1-indexed like R). When <code>NULL</code>, the
array is flattened first.</p></dd>


<dt id="arg-kth">kth<a class="anchor" aria-label="anchor" href="#arg-kth"></a></dt>
<dd><p>Zero-based index of the element that should be placed in-order
after partitioning.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>An mlx array. For <code>mlx_argpartition()</code>, returns 1-based indices
(following R conventions) showing the partition ordering.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>

<ul><li><p><code>mlx_topk()</code> returns the largest <code>k</code> values along the specified axis.</p></li>
<li><p><code>mlx_partition()</code> rearranges elements so the kth element is correctly positioned.</p></li>
<li><p><code>mlx_argpartition()</code> returns the <strong>1-based indices</strong> that would partition
the array. This follows R's indexing convention (unlike the underlying MLX
library which uses 0-based indexing).</p></li>
</ul><p>Use <code><a href="mlx_sort.html">mlx_argsort()</a></code> if you need fully sorted indices.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><a href="https://ml-explore.github.io/mlx/build/html/python/array.html#mlx.core.topk" class="external-link">mlx.core.topk</a>,
<a href="https://ml-explore.github.io/mlx/build/html/python/array.html#mlx.core.partition" class="external-link">mlx.core.partition</a>,
<a href="https://ml-explore.github.io/mlx/build/html/python/array.html#mlx.core.argpartition" class="external-link">mlx.core.argpartition</a></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">scores</span> <span class="op">&lt;-</span> <span class="fu"><a href="as_mlx.html">as_mlx</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.7</span>, <span class="fl">0.2</span>, <span class="fl">0.9</span>, <span class="fl">0.4</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">mlx_topk</span><span class="op">(</span><span class="va">scores</span>, k <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> mlx array [2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   dtype: float32</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   device: gpu</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   values:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.7 0.9</span>
<span class="r-in"><span><span class="fu">mlx_partition</span><span class="op">(</span><span class="va">scores</span>, kth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> mlx array [4]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   dtype: float32</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   device: gpu</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   values:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.2 0.4 0.7 0.9</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Returns 1-based indices</span></span></span>
<span class="r-in"><span><span class="va">idx</span> <span class="op">&lt;-</span> <span class="fu">mlx_argpartition</span><span class="op">(</span><span class="va">scores</span>, kth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">idx</span><span class="op">)</span><span class="op">)</span>  <span class="co"># 1-based indices</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 2 4 1 3</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">mlx_topk</span><span class="op">(</span><span class="fu"><a href="as_mlx.html">as_mlx</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">6</span>, <span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span>, k <span class="op">=</span> <span class="fl">1</span>, axis <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> mlx array [1 x 3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   dtype: float32</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   device: gpu</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   values:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      [,1] [,2] [,3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]    2    4    6</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by David Hugh-Jones.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

